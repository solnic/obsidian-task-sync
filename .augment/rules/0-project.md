---
type: "always_apply"
---

# Current Project Context

Project: Obsidian Task Sync
Status: UNRELEASED

# READ THIS BEFORE DOING ANYTHING!

The project is in a transition phase moving from an Obsidian plugin to a Svelte app that has Obsidian support as an extension. Previous code was moved to `old-stuff` and should be used as a reference when re-introducing functionality within the new architecture.

# COMMANDS FOR RUNNING TESTS

- `npm test` to run all tests
- `npm run test:e2e` to run all `e2e` tests
- `npm run test:e2e:failed` to run e2e tests that previously failed
- `npm run test:e2e -- -g "pattern"` to run all `e2e` tests matching pattern


# ðŸš¨ IMPORTANT INFORMATION ABOUT E2E TESTS ðŸš¨

- The project is in transition phase from `vitest` with `playwright` to just `playwright` - all new e2e tests from now on must be implemented in `playwright` only
- All existing `vitest` e2e tests will be migrated to `playwright` gradually

# ðŸš¨ IMPLEMENTATION RULES - NEVER VIOLATE ðŸš¨

- There is a lot of very defensive code in this code base with complex error try/catch logic and awful fallbacks like `foo.?bar || 0` - such code is bad and you MUST NOT follow such patterns when writing new code or changing existing code.

# ðŸš¨ TESTING RULES - NEVER VIOLATE ðŸš¨

- `e2e` tests are the most important tests in this project as they test real interactions with the Obsidian API and the UI
- DO NOT write unit tests for anything other than simple low-level utilities where UI is not involved, everything else MUST BE COVERED BY E2E TESTS

# ðŸš¨ UNIT TESTING RULES - NEVER VIOLATE ðŸš¨

- Do not mock Obsidian APIs - any feature that relies on Obsidian APIs must be tested in e2e tests

# ðŸš¨ E2E TESTING RULES - NEVER VIOLATE ðŸš¨

- Do not use fixed timeouts in tests - instead use smart-waiting strategy. Implement helpers for smart-waiting if necessery.
- You MUST ALWAYS see what test helpers are available and AVOID complex code in test scenarios

# Debugging failing e2e tests

- Debug test artifacts can be found in `tests/e2e/debug`
- Run tests with `DEBUG=true` to see console output from the Obsidian electron app

## UI and front-end

- `styles.css` is generated by the CSS build process. To change styles you must only edit CSS in `src/styles`
- DO NOT add inline styles to Svelte components, instead add them to appropriate file in `src/styles`
